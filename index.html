<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Green-Therapy – CBD Premium</title>
  <meta name="description" content="Spécialiste du CBD premium depuis 2019 : fleurs, résines, huiles et infusions de haute qualité. Produits naturels sélectionnés en Italie.">
  <meta name="robots" content="index, follow">
  <meta name="author" content="Green-Therapy">
  <link rel="icon" href="favicon.ico" type="image/x-icon" />

  <!-- Préconnexion CDN -->
  <link rel="preconnect" href="https://cdn.snipcart.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>

  <!-- CSS principal -->
  <link rel="stylesheet" href="style.css" />

  <!-- CSS Snipcart préchargé -->
  <link rel="preload" href="https://cdn.snipcart.com/themes/v3.0.31/default/snipcart.css" as="style" onload="this.onload=null;this.rel='stylesheet';"/>
  <noscript><link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.31/default/snipcart.css" /></noscript>

  <!-- Snipcart Configuration -->
  <script>
    window.SnipcartSettings = {
      publicApiKey: "MjUwNWU1NDctZmQwOC00YmEwLTlkMTItMWMxZmYyYWI5MzdhNjM4ODk3NzU4MjkzMjE0MDQ3",
      loadStrategy: "on-user-interaction"
    };
  </script>

  <!-- Petites règles locales -->
  <style>
    .header-panier{ text-align:left; margin-top:10px; margin-left:100px; }
    .panier-btn{ background:none; border:none; color:#d4af37; font-size:16px; cursor:pointer; }

    /* Bouton noir + texte doré pour l'ajout au panier */
    .product-card .cta-cart{
      background:#000;
      color:#d4af37;
      font-weight:700;
      padding:8px 12px;
      border-radius:8px;
      border:1px solid #000;
      cursor:pointer;
      transition:opacity .2s ease;
      display:inline-flex;
      align-items:center;
      gap:.5rem;
    }
    .product-card .cta-cart:hover{ opacity:.9; }

    /* étiquette stock (injectée par JS) */
    .stock-label{ margin-top:6px; font-size:.9rem; }
    .stock-out{ color:#b00020; }
    .stock-in{ color:#2e7d32; }
    .btn-disabled{ opacity:.55; cursor:not-allowed; }
  </style>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="logo-container">
      <img src="logo-rond.png" alt="Logo Green Therapy - CBD Premium" class="logo" loading="lazy" width="80" height="80" />
      <h1>Green-Therapy</h1>
    </div>

    <nav>
      <a href="#home">🏠 Accueil</a>
      <a href="#produits">🛍️ Produits</a>
      <a href="#contact">✉️ Contact</a>
      <a href="pt/index.html" hreflang="pt">🇵🇹 Portugais</a>
    </nav>

    <div class="header-panier">
      <button class="snipcart-checkout panier-btn">🛒 Voir le panier</button>
    </div>
  </header>

  <!-- Accueil -->
  <section id="home" class="section">
    <h2>
      <span style="display:inline-block; text-align:center;">
        <span style="display:block;">🌿 Green-Therapy 🌿</span>
        <span style="display:block;">CBD Premium</span>
      </span>
    </h2>
    <p>Spécialiste du CBD depuis 2019, nous sélectionnons en Italie des fleurs de CBD premium, huiles de CBD full spectrum, résines et infusions. Découvrez des produits naturels et de qualité pour un moment de détente authentique.</p>
  </section>

  <!-- Produits -->
  <section id="produits" class="section">
    <h2>🛍️ Nos Produits</h2>
    <div class="product-grid">

      <!-- Produit 1 -->
      <div class="product-card" data-id="amnesia-cbd" data-stock="10g">
        <picture>
          <source srcset="amnesia-cbd.webp" type="image/webp" />
          <img src="amnesia-cbd.jpg" alt="Fleur CBD Amnesia - Italie" class="product-img" loading="lazy" width="400" height="400" />
        </picture>
        <h3>🌿 Fleur CBD Amnesia 🇮🇹</h3>
        <p class="price">À partir de 8,90 €</p>
        <select id="amnesia-quantite" aria-label="Choisir la quantité pour Fleur CBD Amnesia">
          <option value="2" selected>2g – 8,90 €</option>
          <option value="4">4g – 17,00 €</option>
          <option value="6">6g – 24,00 €</option>
          <option value="8">8g – 30,00 €</option>
          <option value="10">10g – 40,00 €</option>
        </select>
        <button class="cta-cart" onclick="ajouterProduit('amnesia-cbd','Fleur CBD Amnesia','Fleur CBD premium d’Italie','amnesia-quantite')">
          🛒 Ajouter au panier
        </button>
      </div>

      <!-- Produit 2 -->
      <div class="product-card" data-id="resine-cbd" data-stock="0">
        <picture>
          <source srcset="resine-cbd.webp" type="image/webp" />
          <img src="resine-cbd.jpg" alt="Résine CBD Hash - Italie" class="product-img" loading="lazy" width="400" height="400" />
        </picture>
        <h3>🌴 Résine CBD Hash 🇮🇹</h3>
        <p class="price">À partir de 7,50 €</p>
        <select id="resine-quantite" aria-label="Choisir la quantité pour Résine CBD Hash">
          <option value="2" selected>2g – 7,50 €</option>
          <option value="4">4g – 14,00 €</option>
          <option value="6">6g – 20,00 €</option>
          <option value="8">8g – 26,00 €</option>
          <option value="10">10g – 32,00 €</option>
        </select>
        <button class="cta-cart" onclick="ajouterProduit('resine-cbd','Résine CBD Hash','Résine CBD premium d’Italie','resine-quantite')">
          🛒 Ajouter au panier
        </button>
      </div>

      <!-- Produit 3 -->
      <div class="product-card" data-id="cherry-cbd" data-stock="0">
        <picture>
          <source srcset="cherry-cbd.webp" type="image/webp" />
          <img src="cherry-cbd.jpg" alt="Fleur CBD Cherry - Italie" class="product-img" loading="lazy" width="400" height="400" />
        </picture>
        <h3>🍒 Fleur CBD Cherry 🇮🇹</h3>
        <p class="price">À partir de 9,50 €</p>
        <select id="cherry-quantite" aria-label="Choisir la quantité pour Fleur CBD Cherry">
          <option value="2" selected>2g – 9,50 €</option>
          <option value="4">4g – 18,00 €</option>
          <option value="6">6g – 26,00 €</option>
          <option value="8">8g – 33,00 €</option>
          <option value="10">10g – 40,00 €</option>
        </select>
        <button class="cta-cart" onclick="ajouterProduit('cherry-cbd','Fleur CBD Cherry','Fleur CBD Cherry premium d’Italie','cherry-quantite')">
          🛒 Ajouter au panier
        </button>
      </div>

    </div>
  </section>

  <!-- Avis Clients -->
  <section id="avis" class="section">
    <h2>⭐ Avis Clients</h2>
    <div class="avis-grid">
      <div class="avis-card">
        <p class="avis-texte">“Livraison rapide et discrète, fleurs de qualité exceptionnelle. Je recommande 100% !”</p>
        <div class="avis-stars" aria-label="Évaluation 5 étoiles">⭐⭐⭐⭐⭐</div>
        <p class="avis-nom">– Julien M.</p>
      </div>
      <div class="avis-card">
        <p class="avis-texte">“Une vraie découverte ! L’huile de CBD m’aide à mieux dormir. Service client excellent.”</p>
        <div class="avis-stars" aria-label="Évaluation 5 étoiles">⭐⭐⭐⭐⭐</div>
        <p class="avis-nom">– Sophie L.</p>
      </div>
      <div class="avis-card">
        <p class="avis-texte">“Excellent rapport qualité/prix. Goût, arôme, détente… tout est parfait.”</p>
        <div class="avis-stars" aria-label="Évaluation 5 étoiles">⭐⭐⭐⭐⭐</div>
        <p class="avis-nom">– Karim B.</p>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="section">
    <h2>✉️ Contact</h2>
    <p>Contactez-nous pour toute question ou demande spéciale.</p>
    <p><a href="mailto:greentherapy06@gmail.com" title="Envoyez-nous un e-mail">📧 greentherapy06@gmail.com</a></p>
  </section>

  <!-- Snipcart (hidden) -->
  <div hidden id="snipcart"
    data-api-key="MjUwNWU1NDctZmQwOC00YmEwLTlkMTItMWMxZmYyYWI5MzdhNjM4ODk3NzU4MjkzMjE0MDQ3"
    data-config-modal-style="side"
    data-currency="eur">
  </div>

  <!-- Prix + Stock + Ajout Snipcart (unifié) -->
  <script>
    const prixParProduit = {
      "amnesia-cbd": {2: 8.90, 4: 17.00, 6: 24.00, 8: 30.00, 10: 40.00},
      "resine-cbd":  {2: 7.50, 4: 14.00, 6: 20.00, 8: 26.00, 10: 32.00},
      "cherry-cbd":  {2: 9.50, 4: 18.00, 6: 26.00, 8: 33.00, 10: 40.00}
    };
    const LANG = (document.documentElement.lang || 'fr').toLowerCase();
    const TXT = LANG.startsWith('pt')
      ? { instock: 'Em stock: ', out: 'Esgotado' }
      : { instock: 'En stock : ', out: 'Rupture de stock' };

    function getStock(id) {
      const card = document.querySelector(`.product-card[data-id="${id}"]`);
      if (!card) return 0;
      const n = parseInt(card.getAttribute('data-stock'), 10);
      return isNaN(n) ? 0 : n;
    }

    function renderStocks(){
      document.querySelectorAll('.product-card').forEach(card => {
        const id = card.dataset.id;
        if (!id) return;

        let label = card.querySelector('.stock-label');
        if (!label){
          label = document.createElement('div');
          label.className = 'stock-label';
          card.appendChild(label);
        }
        const btn = card.querySelector('.cta-cart');
        const n = getStock(id);

        if (n <= 0){
          label.textContent = TXT.out;
          label.classList.remove('stock-in'); label.classList.add('stock-out');
          if (btn){ btn.setAttribute('disabled','disabled'); btn.classList.add('btn-disabled'); btn.title = TXT.out; }
        } else {
          label.textContent = TXT.instock + n;
          label.classList.remove('stock-out'); label.classList.add('stock-in');
          if (btn){ btn.removeAttribute('disabled'); btn.classList.remove('btn-disabled'); btn.removeAttribute('title'); }
        }
      });
    }
    document.addEventListener('DOMContentLoaded', renderStocks);

    function ensureSnipcartReady(cb){
      if (window.Snipcart && window.Snipcart.api) return cb();
      if (typeof loadSnipcart === 'function') loadSnipcart();
      const start = Date.now();
      const t = setInterval(() => {
        if (window.Snipcart && window.Snipcart.api) { clearInterval(t); cb(); }
        if (Date.now() - start > 5000) { clearInterval(t); }
      }, 100);
    }

    function ajouterProduit(idBase, nomBase, description, selectId) {
      if (getStock(idBase) <= 0){
        alert(TXT.out);
        return;
      }
      const quantite = document.getElementById(selectId).value;
      const prix = prixParProduit[idBase][quantite];
      const id = `${idBase}-${quantite}g`;
      const nom = `${nomBase} ${quantite}g`;

      ensureSnipcartReady(() => {
        Snipcart.api.cart.items.add({ id, name: nom, price: prix, url: '/', description });
      });
    }
  </script>

  <!-- Chargement différé Snipcart -->
  <script>
    let snipcartLoaded = false;
    function loadSnipcart() {
      if (snipcartLoaded) return;
      snipcartLoaded = true;
      const script = document.createElement("script");
      script.src = "https://cdn.snipcart.com/themes/v3.0.31/default/snipcart.js";
      script.async = true;
      document.body.appendChild(script);
    }
    window.addEventListener("scroll", loadSnipcart, { once: true });
    document.addEventListener("click", loadSnipcart, { once: true });
  </script>

  <footer style="text-align:center; padding:20px; font-size:14px;">
    <a href="mentions-legales.html">Mentions légales</a> |
    <a href="politique-confidentialite.html">Politique de confidentialité</a> |
    <a href="cookies.html">Cookies</a>
  </footer>
</body>
</html>
